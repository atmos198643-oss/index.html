<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <style>
        body { 
            background: #121212; 
            color: #fff; 
            font-family: 'Comic Sans MS', sans-serif; 
            margin: 0; 
            padding: 20px;
        }

        /* Динамическая сетка как в Pinterest */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            grid-auto-rows: 10px;
            gap: 20px;
        }

        .card {
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
            position: relative;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.5);
            /* Эффект случайного наклона */
            transform: rotate(calc(var(--r, 0) * 1deg));
        }

        .active {
            transform: scale(1.1) rotate(0deg) !important;
            z-index: 100;
            box-shadow: 0 0 30px #fff;
            border: 3px solid white;
        }

        /* Разные размеры ячеек */
        .size-s { grid-row-end: span 18; }
        .size-m { grid-row-end: span 25; }
        .size-l { grid-row-end: span 32; }

        .img-container { width: 100%; height: 60%; overflow: hidden; border-radius: 10px; background: rgba(0,0,0,0.2); }
        img { width: 100%; height: 100%; object-fit: cover; }

        .name { font-weight: 900; margin: 10px 0; text-align: center; line-height: 1; }
        .price { background: #000; color: #fff; padding: 5px 15px; border-radius: 20px; font-weight: bold; }

        /* Цвета для фона */
        .bg-1 { background: #FF5733; } .bg-2 { background: #33FF57; }
        .bg-3 { background: #3357FF; } .bg-4 { background: #F333FF; }
        .bg-5 { background: #FF33A8; } .bg-6 { background: #33FFF5; }
        .bg-7 { background: #FFC300; } .bg-8 { background: #DAF7A6; }
    </style>
</head>
<body>
    <div id="board" class="grid">Загрузка хаоса...</div>

    <script>
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQkJg-ateJ916_iAnG4ZUigWnVAh5Rhm0j7wutgrkf2Kl71EIckZiuwcZ4rvs8qEqTqfFEJHwaMdyZc/pub?output=csv";

        async function update() {
            try {
                const res = await fetch(sheetUrl + "&t=" + Math.random());
                const text = await res.text();
                const rows = text.split('\n').map(r => r.split(',').map(c => c.replace(/"/g, '').trim()));
                
                let html = "";
                const sizes = ['size-s', 'size-m', 'size-l'];
                const fonts = ['Impact', 'Courier New', 'Georgia', 'Arial Black', 'Verdana'];

                for (let i = 1; i <= 12; i++) {
                    if (rows[i] && rows[i][1]) {
                        const s = sizes[Math.floor(Math.random() * sizes.length)];
                        const c = Math.floor(Math.random() * 8) + 1;
                        const f = fonts[Math.floor(Math.random() * fonts.length)];
                        const rot = (Math.random() * 6 - 3).toFixed(1); // наклон от -3 до 3 градусов
                        
                        html += `
                        <div class="card ${s} bg-${c}" id="c${i}" style="--r: ${rot}">
                            <div class="img-container">
                                <img src="${rows[i][3]}" onerror="this.src='https://via.placeholder.com/200?text=No+Photo'">
                            </div>
                            <div class="name" style="font-family: ${f}; font-size: ${Math.random()*(2-1)+1.2}vw">${rows[i][1]}</div>
                            <div class="price">${rows[i][2]} €</div>
                        </div>`;
                    }
                }
                document.getElementById("board").innerHTML = html;
            } catch (e) { }
        }

        let cur = 1;
        setInterval(() => {
            const cards = document.querySelectorAll('.card');
            if (cards.length) {
                cards.forEach(c => c.classList.remove('active'));
                const a = document.getElementById('c' + cur);
                if (a) a.classList.add('active');
                cur = (cur % cards.length) + 1;
            }
        }, 3000);

        update();
        setInterval(update, 30000);
    </script>
</body>
</html>
