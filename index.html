<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .card { border: 2px solid #444; padding: 15px; border-radius: 10px; background: #111; }
        .img-box { width: 100%; height: 150px; background: #222; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        img { max-width: 100%; max-height: 100%; border: 1px solid lime; }
        .debug-info { font-size: 10px; color: #888; word-break: break-all; margin-top: 10px; background: #000; padding: 5px; }
        .price { color: gold; font-size: 24px; font-bold: bold; }
    </style>
</head>
<body>
    <h2 id="status">Загрузка...</h2>
    <div id="board" class="grid"></div>

    <script>
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQkJg-ateJ916_iAnG4ZUigWnVAh5Rhm0j7wutgrkf2Kl71EIckZiuwcZ4rvs8qEqTqfFEJHwaMdyZc/pub?output=csv";

        async function update() {
            try {
                const res = await fetch(sheetUrl + "&nocache=" + Math.random());
                const text = await res.text();
                // Разбиваем таблицу на строки
                const rows = text.split('\n');
                
                document.getElementById("status").innerText = "Таблица получена. Строк: " + rows.length;
                
                let html = "";
                // Берем первые 6 товаров для теста
                for (let i = 1; i <= 6; i++) {
                    if (!rows[i]) continue;
                    
                    // Разбиваем строку на колонки
                    const cols = rows[i].split(',');
                    
                    // ВАЖНО: проверяем индексы (0 - ID, 1 - Название, 2 - Цена, 3 - Ссылка)
                    const name = cols[1] ? cols[1].replace(/"/g, '') : "Нет имени";
                    const price = cols[2] ? cols[2].replace(/"/g, '') : "0";
                    const img = cols[3] ? cols[3].replace(/"/g, '').trim() : "ССЫЛКА ОТСУТСТВУЕТ";

                    html += `
                    <div class="card">
                        <div class="img-box">
                            <img src="${img}" title="Картинка">
                        </div>
                        <div class="name"><h3>${name}</h3></div>
                        <div class="price">${price} €</div>
                        <div class="debug-info"><b>Путь к фото:</b><br>${img}</div>
                    </div>`;
                }
                document.getElementById("board").innerHTML = html;
            } catch (e) {
                document.getElementById("status").innerText = "Ошибка загрузки: " + e;
            }
        }
        update();
    </script>
</body>
</html>
